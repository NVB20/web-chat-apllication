{% extends "base.html" %}

{% block title %}Secret Room{% endblock %}

{% block content %}
<div class="message-box">
    <h2>Chat Room: {{code}}</h2>
    <div class="messages" id="messages"></div>
    <div class="inputs">
      <input type="text" rows="3" placeholder="Message" name="message" id="user_message"/>
      <button type="button" name="send" id="send-btn" onClick="sendMessage()">
        Send</button>
    </div>
  </div>

{% for msg in messages %}
<script type="text/javascript">
    createMessage("{{msg.name}}", "{{msg.message}}");

    // Retrieve room from session storage
    const room = sessionStorage.getItem('room');
        
    // Emit 'join' event with the stored room
    socket.emit('join', { "room": room });

    // Store room in session storage
    sessionStorage.setItem("room", room);

</script>
{% endfor %}

{% endblock %}